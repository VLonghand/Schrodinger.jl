<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function Library · Schrodinger.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Schrodinger.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/gettingstarted.html">Getting Started</a></li><li><a class="toctext" href="../man/quantumobjects.html">Quantum Objects</a></li><li><a class="toctext" href="../man/working.html">Working with States and Operators</a></li><li><a class="toctext" href="../man/dynamics.html">Time Evolution and Dynamics</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../examples/DRAG.html">DRAG</a></li></ul></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="quobj.html">Quantum Object Types</a></li><li><a class="toctext" href="states.html">State Library</a></li><li><a class="toctext" href="operators.html">Operator Library</a></li><li class="current"><a class="toctext" href="functions.html">Function Library</a><ul class="internal"></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>API</li><li><a href="functions.html">Function Library</a></li></ul><a class="edit-page" href="https://github.com/jebej/Schrodinger.jl/blob/master/docs/src/api/functions.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Function Library</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Function-Library-1" href="#Function-Library-1">Function Library</a></h1><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Schrodinger.expect-Tuple{Schrodinger.Operator,Schrodinger.Ket}" href="#Schrodinger.expect-Tuple{Schrodinger.Operator,Schrodinger.Ket}"><code>Schrodinger.expect</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">expect(σ,ψ), expect(σ,ρ)</code></pre><p>Compute the expectation value of an operator <span>$σ$</span> given a state ket <span>$|ψ⟩$</span> or a density matrix <span>$ρ$</span>. The expectation value is defined as</p><div>\[\begin{align*}
E(σ,|ψ⟩) &amp;= ⟨ψ|σ|ψ⟩, \\
E(σ,ρ) &amp;= \textrm{tr}(σρ).
\end{align*}

A specialized method exists for vector of `Ket` or `Operator` inputs.\]</div></div><a class="source-link" target="_blank" href="https://github.com/jebej/Schrodinger.jl/blob/5ca04c3af31c740f9f6f897679249db63590d2df/src/math/special.jl#L1-L13">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Schrodinger.fidelity-Tuple{Schrodinger.Operator,Schrodinger.Operator}" href="#Schrodinger.fidelity-Tuple{Schrodinger.Operator,Schrodinger.Operator}"><code>Schrodinger.fidelity</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">fidelity(ρ,σ), fidelity(ρ,ψ), fidelity(ψ,ϕ)</code></pre><p>Compute the fidelity between density matrices <span>$ρ$</span> and <span>$σ$</span>, a density matrix <span>$ρ$</span> and a ket <span>$|ψ⟩$</span>, or two kets <span>$|ψ⟩$</span> and <span>$|ϕ⟩$</span>. The fidelity in those three cases is defined as</p><div>\[\begin{align*}
F(ρ,σ) &amp;= \textrm{tr}\sqrt{ρ^{1/2}σρ^{1/2}}, \\
F(ρ,|ψ⟩) &amp;= \sqrt{⟨ψ|ρ|ψ⟩}, \\
F(|ψ⟩,|ϕ⟩) &amp;= \left|⟨ψ|ϕ⟩\right|.
\end{align*}\]</div><p>See also <a href="functions.html#Schrodinger.fidelity2-Tuple{Schrodinger.Operator,Schrodinger.Operator}"><code>fidelity2</code></a>, which is the square of the state fidelity.</p></div><a class="source-link" target="_blank" href="https://github.com/jebej/Schrodinger.jl/blob/5ca04c3af31c740f9f6f897679249db63590d2df/src/math/special.jl#L83-L95">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Schrodinger.fidelity2-Tuple{Schrodinger.Operator,Schrodinger.Operator}" href="#Schrodinger.fidelity2-Tuple{Schrodinger.Operator,Schrodinger.Operator}"><code>Schrodinger.fidelity2</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">fidelity2(ρ,ψ)</code></pre><p>Compute the Uhlmann state fidelity between density matrices <span>$ρ$</span> and <span>$σ$</span>, a density matrix <span>$ρ$</span> and a ket <span>$|ψ⟩$</span>, or two kets <span>$|ψ⟩$</span> and <span>$|ϕ⟩$</span>. The Uhlmann state fidelity is simply defined as the square of the &quot;regular&quot; state <a href="functions.html#Schrodinger.fidelity-Tuple{Schrodinger.Operator,Schrodinger.Operator}"><code>fidelity</code></a>.</p></div><a class="source-link" target="_blank" href="https://github.com/jebej/Schrodinger.jl/blob/5ca04c3af31c740f9f6f897679249db63590d2df/src/math/special.jl#L113-L117">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Schrodinger.levelprobs-Union{Tuple{N}, Tuple{Schrodinger.Ket{T,N}}, Tuple{T}} where N where T" href="#Schrodinger.levelprobs-Union{Tuple{N}, Tuple{Schrodinger.Ket{T,N}}, Tuple{T}} where N where T"><code>Schrodinger.levelprobs</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">levelprobs(ψ), levelprobs(ψ,s)</code></pre><p>Compute the level occupation probabilities. For a <code>Ket</code>, this simply corresponds to the absolute square of the amplitude of each level. For an <code>Operator</code>, the function returns the diagonal.</p><p>A system index, or vector of indices, can be passed as a second argument. In that case, the full system will first be partial traced to keep only the desired index. Level occupation probabilities are then calculated from the resulting reduced density matrix. If a vector of indices is passed, occupation probabilities are calculated for a fully reduced density matrix for each index.</p><p>A specialized method exists for vector of <code>Ket</code> or <code>Operator</code> inputs.</p></div><a class="source-link" target="_blank" href="https://github.com/jebej/Schrodinger.jl/blob/5ca04c3af31c740f9f6f897679249db63590d2df/src/math/special.jl#L44-L52">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Schrodinger.ptrace-Tuple{Schrodinger.Ket,Any}" href="#Schrodinger.ptrace-Tuple{Schrodinger.Ket,Any}"><code>Schrodinger.ptrace</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">ptrace(ψ, out)</code></pre><p>Compute the partial trace of a state <code>Ket</code> or <code>Bra</code> ψ by tracing out the subsystems specified by <code>out</code>. Returns a density matrix. Multiple subsystems can be traced out by passing a sorted tuple of subsystem indices.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; Φ₊ = normalize!(basis(2,0)⊗basis(2,0) + basis(2,1)⊗basis(2,1)) # Bell pair
4-d Schrodinger.Ket{SparseVector{Float64,Int64},2} with space dimensions 2⊗2:
0.71∠0°|0,0⟩ + 0.71∠0°|1,1⟩

julia&gt; ptrace(Φ₊,1) # trace out qubit 1
2×2 Schrodinger.Operator{Array{Float64,2},1} with space dimensions 2:
 0.5  0.0
 0.0  0.5</code></pre></div><a class="source-link" target="_blank" href="https://github.com/jebej/Schrodinger.jl/blob/5ca04c3af31c740f9f6f897679249db63590d2df/src/math/ptrace.jl#L26-L42">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Schrodinger.ptrace-Tuple{Schrodinger.Operator,Any}" href="#Schrodinger.ptrace-Tuple{Schrodinger.Operator,Any}"><code>Schrodinger.ptrace</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">ptrace(ρ, out)</code></pre><p>Compute the partial trace of a linear <code>Operator</code> ρ by tracing out the subsystems specified by <code>out</code>. Multiple subsystems can be traced out by passing a sorted tuple of subsystem indices.</p><p><strong>Example</strong></p><pre><code class="language-julia">Φ₊ = normalize!(basis(2,0)⊗basis(2,0) + basis(2,1)⊗basis(2,1)) # Bell pair
Ψ₊ = normalize!(basis(2,0)⊗basis(2,1) + basis(2,1)⊗basis(2,0)) # Bell pair
ρ  = 0.25 * Operator(Φ₊) + 0.75 * Operator(Ψ₊) # density matrix
ptrace(ρ,2) # trace out qubit 2
# output
2×2 Schrodinger.Operator{Array{Float64,2},1} with space dimensions 2:
 0.5  0.0
 0.0  0.5</code></pre></div><a class="source-link" target="_blank" href="https://github.com/jebej/Schrodinger.jl/blob/5ca04c3af31c740f9f6f897679249db63590d2df/src/math/ptrace.jl#L3-L19">source</a></section><footer><hr/><a class="previous" href="operators.html"><span class="direction">Previous</span><span class="title">Operator Library</span></a></footer></article></body></html>
